
*************** JDFTx 1.4.2 (git hash 09de4368) ***************

Start date and time: Thu Jun  6 09:58:35 2019
Executable /sdcc/u/jxuucsc/jdftx_codes/jdftx/build/phonon with command-line: -i phonon.in
Running on hosts (process indices):  ichost125.sdcc.bnl.local (0-1)  ichost126.sdcc.bnl.local (2-3)  ichost127.sdcc.bnl.local (4-5)  ichost128.sdcc.bnl.local (6-7)  ichost131.sdcc.bnl.local (8-9)  ichost132.sdcc.bnl.local (10-11)  ichost133.sdcc.bnl.local (12-13)  ichost134.sdcc.bnl.local (14-15)  ichost135.sdcc.bnl.local (16-17)  ichost136.sdcc.bnl.local (18-19)  ichost137.sdcc.bnl.local (20-21)  ichost139.sdcc.bnl.local (22-23)  ichost141.sdcc.bnl.local (24-25)  ichost142.sdcc.bnl.local (26-27)  ichost143.sdcc.bnl.local (28-29)  ichost144.sdcc.bnl.local (30-31)
Divided in process groups (process indices):  0 (0)  1 (1)  2 (2)  3 (3)  4 (4)  5 (5)  6 (6)  7 (7)  8 (8)  9 (9)  10 (10)  11 (11)  12 (12)  13 (13)  14 (14)  15 (15)  16 (16)  17 (17)  18 (18)  19 (19)  20 (20)  21 (21)  22 (22)  23 (23)  24 (24)  25 (25)  26 (26)  27 (27)  28 (28)  29 (29)  30 (30)  31 (31)
Resource initialization completed at t[s]:      0.16
Run totals: 32 processes, 576 threads, 0 GPUs


Input parsed successfully to the following command list (including defaults):

basis kpoint-dependent
converge-empty-states yes
coords-type Lattice
core-overlap-check vector
coulomb-interaction Periodic
davidson-band-ratio 1.1
dump End State ElecDensity
dump-name totalE.$VAR
dump-only 
elec-cutoff 22 145
elec-eigen-algo Davidson
elec-ex-corr gga-PBE
elec-n-bands 44
electronic-minimize  \
	dirUpdateScheme      FletcherReeves \
	linminMethod         DirUpdateRecommended \
	nIterations          100 \
	history              15 \
	knormThreshold       0 \
	energyDiffThreshold  2e-12 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
exchange-regularization WignerSeitzTruncated
fluid None
fluid-ex-corr lda-TF lda-PZ
fluid-gummel-loop 10 1.000000e-05
fluid-minimize  \
	dirUpdateScheme      PolakRibiere \
	linminMethod         DirUpdateRecommended \
	nIterations          100 \
	history              15 \
	knormThreshold       0 \
	energyDiffThreshold  0 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
fluid-solvent H2O 55.338 ScalarEOS \
	epsBulk 78.4 \
	pMol 0.92466 \
	epsInf 1.77 \
	Pvap 1.06736e-10 \
	sigmaBulk 4.62e-05 \
	Rvdw 2.61727 \
	Res 1.42 \
	tauNuc 343133 \
	poleEl 15 7 1
forces-output-coords Positions
initial-state totalE.$VAR
ion Ga   0.000000000000000   0.000000000000000   0.000000000000000 0
ion As   0.250000000000000   0.250000000000000   0.250000000000000 0
ion-species /sdcc/u/jxuucsc/pseudopotentials/psl1.0/rel-pbe/Ga.rel-pbe-dnl-rrkjus_psl.1.0.0.UPF
ion-species /sdcc/u/jxuucsc/pseudopotentials/psl1.0/rel-pbe/As.rel-pbe-dn-rrkjus_psl.1.0.0.UPF
ion-width 0
ionic-minimize  \
	dirUpdateScheme      L-BFGS \
	linminMethod         DirUpdateRecommended \
	nIterations          0 \
	history              15 \
	knormThreshold       0.0001 \
	energyDiffThreshold  1e-06 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
kpoint   0.000000000000   0.000000000000   0.000000000000  1.00000000000000
kpoint-folding 24 24 24 
latt-move-scale 1 1 1
latt-scale 1 1 1 
lattice Face-Centered Cubic 10.6829
lattice-minimize  \
	dirUpdateScheme      L-BFGS \
	linminMethod         DirUpdateRecommended \
	nIterations          0 \
	history              15 \
	knormThreshold       0 \
	energyDiffThreshold  1e-06 \
	nEnergyDiff          2 \
	alphaTstart          1 \
	alphaTmin            1e-10 \
	updateTestStepSize   yes \
	alphaTreduceFactor   0.1 \
	alphaTincreaseFactor 3 \
	nAlphaAdjustMax      3 \
	wolfeEnergy          0.0001 \
	wolfeGradient        0.9 \
	fdTest               no
lcao-params -1 1e-06 0.001
pcm-variant GLSSA13
phonon  \
	supercell 4 4 4 \
	dr 0.1 \
	iPerturbation 1 \
	saveHsub yes \
	T 298 \
	Fcut 1e-08 \
	rSmooth 1
spintype spin-orbit
subspace-rotation-factor 1 yes
symmetries automatic
symmetry-threshold 0.0001


########### Unit cell calculation #############

---------- Setting up symmetries ----------

Found 48 point-group symmetries of the bravais lattice
Found 24 space-group symmetries with basis
Applied RMS atom displacement 0 bohrs to make symmetries exact.

---------- Initializing the Grid ----------
R = 
[          0    5.34145    5.34145  ]
[    5.34145          0    5.34145  ]
[    5.34145    5.34145          0  ]
unit cell volume = 304.795
G =
[  -0.588154   0.588154   0.588154  ]
[   0.588154  -0.588154   0.588154  ]
[   0.588154   0.588154  -0.588154  ]
Minimum fftbox size, Smin = [  44  44  44  ]
Chosen fftbox size, S = [  48  48  48  ]

---------- Initializing tighter grid for wavefunction operations ----------
R = 
[          0    5.34145    5.34145  ]
[    5.34145          0    5.34145  ]
[    5.34145    5.34145          0  ]
unit cell volume = 304.795
G =
[  -0.588154   0.588154   0.588154  ]
[   0.588154  -0.588154   0.588154  ]
[   0.588154   0.588154  -0.588154  ]
Minimum fftbox size, Smin = [  32  32  32  ]
Chosen fftbox size, S = [  32  32  32  ]

---------- Exchange Correlation functional ----------
Initalized PBE GGA exchange.
Initalized PBE GGA correlation.

---------- Setting up pseudopotentials ----------
Width of ionic core gaussian charges (only for fluid interactions / plotting) set to 0

Reading pseudopotential file '/sdcc/u/jxuucsc/pseudopotentials/psl1.0/rel-pbe/Ga.rel-pbe-dnl-rrkjus_psl.1.0.0.UPF':
  'Ga' pseudopotential, 'PBE' functional
  Generated using "atomic" code by A. Dal Corso  v.6.1
  Author: ADC  Date:  4Jun2019.
  13 valence electrons, 5 orbitals, 10 projectors, 1205 radial grid points, with lMax = 2
  Transforming core density to a uniform radial grid of dG=0.02 with 2346 points.
  Transforming local potential to a uniform radial grid of dG=0.02 with 2346 points.
  Transforming nonlocal projectors to a uniform radial grid of dG=0.02 with 453 points.
  Transforming density augmentations to a uniform radial grid of dG=0.02 with 2346 points.
    4S    l: 0   occupation:  2.0   eigenvalue: -0.327043
    4P    l: 1   occupation:  1.0   eigenvalue: -0.096365
    4P    l: 1   occupation:  0.0   eigenvalue: -0.092144
    3D    l: 2   occupation:  4.0   eigenvalue: -0.711348
    3D    l: 2   occupation:  6.0   eigenvalue: -0.694390
  Transforming atomic orbitals to a uniform radial grid of dG=0.02 with 453 points.
  WARNING: large normalization error in atomic orbital 1p (integral: 0.921141).
  WARNING: large normalization error in atomic orbital 2p (integral: 0.926860).
  WARNING: large normalization error in atomic orbital 1d (integral: 3.140769).
  WARNING: large normalization error in atomic orbital 2d (integral: 3.175352).
  Core radius for overlap checks: 2.18 bohrs.

Reading pseudopotential file '/sdcc/u/jxuucsc/pseudopotentials/psl1.0/rel-pbe/As.rel-pbe-dn-rrkjus_psl.1.0.0.UPF':
  'As' pseudopotential, 'PBE' functional
  Generated using "atomic" code by A. Dal Corso  v.6.1
  Author: ADC  Date:  4Jun2019.
  15 valence electrons, 5 orbitals, 10 projectors, 1209 radial grid points, with lMax = 2
  Transforming core density to a uniform radial grid of dG=0.02 with 2346 points.
  Transforming local potential to a uniform radial grid of dG=0.02 with 2346 points.
  Transforming nonlocal projectors to a uniform radial grid of dG=0.02 with 453 points.
  Transforming density augmentations to a uniform radial grid of dG=0.02 with 2346 points.
    4S    l: 0   occupation:  2.0   eigenvalue: -0.529616
    4P    l: 1   occupation:  2.0   eigenvalue: -0.195442
    4P    l: 1   occupation:  1.0   eigenvalue: -0.185480
    3D    l: 2   occupation:  4.0   eigenvalue: -1.504478
    3D    l: 2   occupation:  6.0   eigenvalue: -1.477709
  Transforming atomic orbitals to a uniform radial grid of dG=0.02 with 453 points.
  WARNING: large normalization error in atomic orbital 1p (integral: 0.910925).
  WARNING: large normalization error in atomic orbital 2p (integral: 0.920299).
  WARNING: large normalization error in atomic orbital 1d (integral: 3.461474).
  WARNING: large normalization error in atomic orbital 2d (integral: 3.510726).
  Core radius for overlap checks: 1.78 bohrs.

Initialized 2 species with 2 total atoms.

Folded 1 k-points by 24x24x24 to 13824 k-points.

---------- Setting up k-points, bands, fillings ----------
Adding inversion symmetry to k-mesh for non-inversion-symmetric unit cell.
Reduced to 413 k-points under symmetry. 
Computing the number of bands and number of electrons
Calculating initial fillings.
Turning on subspace rotations due to non-scalar fillings.
nElectrons:  28.000000   nBands: 44   nStates: 413

----- Setting up reduced wavefunction bases (one per k-point) -----
average nbasis = 1502.306 , ideal nbasis = 1502.227

---------- Setting up ewald sum ----------
Optimum gaussian width for ewald sums = 2.425994 bohr.
Real space sum over 1331 unit cells with max indices [  5  5  5  ]
Reciprocal space sum over 2197 terms with max indices [  6  6  6  ]

---------- Allocating electronic variables ----------
Initializing wave functions:  reading from 'totalE.wfns'


----- Initializing Supercell corresponding to k-point mesh -----
Lattice vector linear combinations in supercell:
[  24   0   0  ]
[   0  24   0  ]
[   0   0  24  ]
Supercell lattice vectors:
[  0  128.195  128.195  ]
[  128.195  0  128.195  ]
[  128.195  128.195  0  ]

----------- Energy evaluation at fixed state -------------
# Energy components:
   Eewald =      -99.1861145153360724
       EH =       82.8217662017806902
     Eloc =     -183.3259283098675496
      Enl =       21.6834076853396702
      Exc =      -47.9451053848040090
 Exc_core =       16.3921904280305206
       KE =       19.7519818008588430
-------------------------------------
     Etot =     -189.8078020939979069

Fcut=1e-08 reduced nBands from 44 to 28 per unit cell.

------- Configuring supercell and perturbation modes -------

---------- Setting up symmetries ----------

Found 48 point-group symmetries of the bravais lattice
Found 24 space-group symmetries with basis (with translations restricted to unit cells)
Applied RMS atom displacement 0 bohrs to make symmetries exact.

Finding maximally-symmetric orthogonal basis for displacements:
 [ +0.577350 +0.577350 +0.577350 ] |Stabilizer|: 6
 [ -0.816497 +0.408248 +0.408248 ] |Stabilizer|: 2
 [ +0.000000 -0.707107 +0.707107 ] |Stabilizer|: 2

12 signed perturbations of the unit cell reduced to 4 under symmetries:
Ga 0  [ +0.577350 +0.577350 +0.577350 ] 1.500000
Ga 0  [ -0.577350 -0.577350 -0.577350 ] 1.500000
As 0  [ +0.577350 +0.577350 +0.577350 ] 1.500000
As 0  [ -0.577350 -0.577350 -0.577350 ] 1.500000

Calculating unitary rotations of unit cell states under symmetries:
	Matrix elements valid for all available states (all degenerate subspaces are complete).
	RMS unitarity error in valid subspaces: 0.000000e+00

---- Citations for features of the code used in this run ----

   Software package:
      R. Sundararaman, K. Letchworth-Weaver, K.A. Schwarz, D. Gunceler, Y. Ozhabes and T.A. Arias, 'JDFTx: software for joint density-functional theory', SoftwareX 6, 278 (2017)

   gga-PBE exchange-correlation functional:
      J.P. Perdew, K. Burke and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)

   Total energy minimization:
      T.A. Arias, M.C. Payne and J.D. Joannopoulos, Phys. Rev. Lett. 69, 1077 (1992)

This list may not be complete. Please suggest additional citations or
report any other bugs at https://github.com/shankar1729/jdftx/issues

########### Perturbed supercell calculation 1 of 4 #############

---------- Setting up symmetries ----------

Found 48 point-group symmetries of the bravais lattice
Found 6 space-group symmetries with basis
Applied RMS atom displacement 0 bohrs to make symmetries exact.

---------- Initializing the Grid ----------
R = 
[          0    21.3658    21.3658  ]
[    21.3658          0    21.3658  ]
[    21.3658    21.3658          0  ]
unit cell volume = 19506.9
G =
[  -0.147038   0.147038   0.147038  ]
[   0.147038  -0.147038   0.147038  ]
[   0.147038   0.147038  -0.147038  ]
Minimum fftbox size, Smin = [  164  164  164  ]
Chosen fftbox size, S = [  192  192  192  ]

---------- Initializing tighter grid for wavefunction operations ----------
R = 
[          0    21.3658    21.3658  ]
[    21.3658          0    21.3658  ]
[    21.3658    21.3658          0  ]
unit cell volume = 19506.9
G =
[  -0.147038   0.147038   0.147038  ]
[   0.147038  -0.147038   0.147038  ]
[   0.147038   0.147038  -0.147038  ]
Minimum fftbox size, Smin = [  128  128  128  ]
Chosen fftbox size, S = [  128  128  128  ]

---------- Exchange Correlation functional ----------
Initalized PBE GGA exchange.
Initalized PBE GGA correlation.

---------- Setting up pseudopotentials ----------
Width of ionic core gaussian charges (only for fluid interactions / plotting) set to 0

Reading pseudopotential file '/sdcc/u/jxuucsc/pseudopotentials/psl1.0/rel-pbe/Ga.rel-pbe-dnl-rrkjus_psl.1.0.0.UPF':
  'Ga' pseudopotential, 'PBE' functional
  Generated using "atomic" code by A. Dal Corso  v.6.1
  Author: ADC  Date:  4Jun2019.
  13 valence electrons, 5 orbitals, 10 projectors, 1205 radial grid points, with lMax = 2
  Transforming core density to a uniform radial grid of dG=0.02 with 2346 points.
  Transforming local potential to a uniform radial grid of dG=0.02 with 2346 points.
  Transforming nonlocal projectors to a uniform radial grid of dG=0.02 with 453 points.
  Transforming density augmentations to a uniform radial grid of dG=0.02 with 2346 points.
    4S    l: 0   occupation:  2.0   eigenvalue: -0.327043
    4P    l: 1   occupation:  1.0   eigenvalue: -0.096365
    4P    l: 1   occupation:  0.0   eigenvalue: -0.092144
    3D    l: 2   occupation:  4.0   eigenvalue: -0.711348
    3D    l: 2   occupation:  6.0   eigenvalue: -0.694390
  Transforming atomic orbitals to a uniform radial grid of dG=0.02 with 453 points.
  WARNING: large normalization error in atomic orbital 1p (integral: 0.921141).
  WARNING: large normalization error in atomic orbital 2p (integral: 0.926860).
  WARNING: large normalization error in atomic orbital 1d (integral: 3.140769).
  WARNING: large normalization error in atomic orbital 2d (integral: 3.175352).
  Core radius for overlap checks: 2.18 bohrs.

Reading pseudopotential file '/sdcc/u/jxuucsc/pseudopotentials/psl1.0/rel-pbe/As.rel-pbe-dn-rrkjus_psl.1.0.0.UPF':
  'As' pseudopotential, 'PBE' functional
  Generated using "atomic" code by A. Dal Corso  v.6.1
  Author: ADC  Date:  4Jun2019.
  15 valence electrons, 5 orbitals, 10 projectors, 1209 radial grid points, with lMax = 2
  Transforming core density to a uniform radial grid of dG=0.02 with 2346 points.
  Transforming local potential to a uniform radial grid of dG=0.02 with 2346 points.
  Transforming nonlocal projectors to a uniform radial grid of dG=0.02 with 453 points.
  Transforming density augmentations to a uniform radial grid of dG=0.02 with 2346 points.
    4S    l: 0   occupation:  2.0   eigenvalue: -0.529616
    4P    l: 1   occupation:  2.0   eigenvalue: -0.195442
    4P    l: 1   occupation:  1.0   eigenvalue: -0.185480
    3D    l: 2   occupation:  4.0   eigenvalue: -1.504478
    3D    l: 2   occupation:  6.0   eigenvalue: -1.477709
  Transforming atomic orbitals to a uniform radial grid of dG=0.02 with 453 points.
  WARNING: large normalization error in atomic orbital 1p (integral: 0.910925).
  WARNING: large normalization error in atomic orbital 2p (integral: 0.920299).
  WARNING: large normalization error in atomic orbital 1d (integral: 3.461474).
  WARNING: large normalization error in atomic orbital 2d (integral: 3.510726).
  Core radius for overlap checks: 1.78 bohrs.

Initialized 2 species with 128 total atoms.

Folded 1 k-points by 6x6x6 to 216 k-points.

---------- Setting up k-points, bands, fillings ----------
Adding inversion symmetry to k-mesh for non-inversion-symmetric unit cell.
Reduced to 32 k-points under symmetry. 
Computing the number of bands and number of electrons
Calculating initial fillings.
nElectrons: 1792.000000   nBands: 1792   nStates: 32

----- Setting up reduced wavefunction bases (one per k-point) -----
average nbasis = 96147.588 , ideal nbasis = 96142.518

---------- Setting up ewald sum ----------
Optimum gaussian width for ewald sums = 4.851988 bohr.
Real space sum over 343 unit cells with max indices [  3  3  3  ]
Reciprocal space sum over 12167 terms with max indices [  11  11  11  ]

---------- Allocating electronic variables ----------
Initializing wave functions:  reading from 'totalE.phonon.1.wfns'


-------- Electronic minimization -----------
ElecMinimize: Iter:   0  Etot: -12147.698794341386019  |grad|_K:       -nan  alpha:  1.000e+00
ElecMinimize: 	Step increased Etot by 6.184564e-11, reducing alpha to 2.759305e-02.
ElecMinimize: 	Step increased Etot by 2.000888e-11, reducing alpha to 2.759305e-03.
ElecMinimize: 	Step increased Etot by 3.092282e-11, reducing alpha to 2.759305e-04.
ElecMinimize: 	Step failed to reduce Etot after 3 attempts. Quitting step.
ElecMinimize: 	Undoing step.
ElecMinimize: 	Step failed along negative gradient direction.
ElecMinimize: Probably at roundoff error limit. (Stopping)
Setting wave functions to eigenvectors of Hamiltonian
Energy change: 8.43241e-06 / unit cell
RMS force: 0.000691582

Dumping 'totalE.phonon.1.wfns' ... done
Dumping 'totalE.phonon.1.n' ... done
Dumping 'totalE.phonon.1.Vscloc' ... done
Dumping 'totalE.phonon.1.dforces' ... done.

Completed supercell calculation for iPerturbation 1.
After completing all supercells, rerun with option collectPerturbations in command phonon.
End date and time: Thu Jun  6 11:21:02 2019  (Duration: 0-1:22:27.56)
Done!

PROFILER:             augmentDensityGrid    38.667742 +/-    49.016547 s,   16 calls,    618.683866 s total
PROFILER:         augmentDensityGridGrad     5.651415 +/-     5.311434 s,   16 calls,     90.422633 s total
PROFILER:        augmentDensitySpherical     0.100941 +/-     0.129219 s,   38 calls,      3.835746 s total
PROFILER:    augmentDensitySphericalGrad     0.068933 +/-     0.133722 s,   60 calls,      4.135975 s total
PROFILER:                 augmentOverlap     4.223442 +/-     9.076240 s,  146 calls,    616.622555 s total
PROFILER:                     changeGrid     0.004421 +/-     0.006828 s,   36 calls,      0.159146 s total
PROFILER:                     diagouterI     8.060776 +/-    10.552569 s,   19 calls,    153.154737 s total
PROFILER:              EdensityAndVscloc     1.297018 +/-     0.572083 s,    8 calls,     10.376148 s total
PROFILER:                     EnlAndGrad     0.174894 +/-     0.301198 s,   64 calls,     11.193201 s total
PROFILER:            ExCorrCommunication     0.837151 +/-     2.723179 s,   42 calls,     35.160335 s total
PROFILER:               ExCorrFunctional     0.004873 +/-     0.002631 s,   15 calls,      0.073090 s total
PROFILER:                    ExCorrTotal     2.741376 +/-     4.585172 s,   15 calls,     41.120639 s total
PROFILER:                   Idag_DiagV_I    11.730181 +/-    18.150173 s,   17 calls,    199.413075 s total
PROFILER:            matrix::diagonalize     0.182659 +/-     0.789135 s,  214 calls,     39.089120 s total
PROFILER:                    matrix::set     0.000981 +/-     0.004973 s, 4897 calls,      4.804092 s total
PROFILER:            phonon::setSupState     0.003636 +/-     0.000000 s,    1 calls,      0.003636 s total
PROFILER:     RadialFunctionR::transform     0.010204 +/-     0.020298 s,  492 calls,      5.020608 s total
PROFILER:                    reduceKmesh     0.233544 +/-     0.158659 s,    2 calls,      0.467088 s total
PROFILER:                            Y*M     2.559097 +/-     4.544321 s,  206 calls,    527.173890 s total
PROFILER:                          Y1^Y2     1.672779 +/-     4.139730 s,  335 calls,    560.381102 s total

MEMUSAGE:                   ColumnBundle    37.818692 GB
MEMUSAGE:             complexScalarField     0.210938 GB
MEMUSAGE:        complexScalarFieldTilde     0.562500 GB
MEMUSAGE:                    IndexArrays     0.087171 GB
MEMUSAGE:                         matrix     1.311330 GB
MEMUSAGE:                           misc     0.321689 GB
MEMUSAGE:                    ScalarField     0.583374 GB
MEMUSAGE:               ScalarFieldTilde     0.481270 GB
MEMUSAGE:                          Total    38.874584 GB
